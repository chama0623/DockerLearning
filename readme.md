# Dockerのメモ

目次
 1. 目的
 2. Dockerの概念  
    2.1 サーバ仮想化  
    2.2 Dockerとは  
 3. 実行環境とDockerの環境構築
    3.1 実行環境  
    3.2 Dockerの環境構築
 4. Dockerの使い方  
    4.1 Hello World!  
    4.2 イメージとコンテナ  
    4.3 Dockerfile  
    4.4 docker-compose  

参考文献

## 1. 目的
研究やシステム開発, 趣味などで「とりあえず動作する環境が欲しい」「軽くソフトウェアやプログラミング言語に触りたい」という需要が増えてきている. また筆者に次のような要望・依頼を数件いただいている.
- Dockerの使い方を教えてほしい
- 仮想化技術を用いて開発環境を整えたい
- 複数イメージを組み合わせて開発を行う方法が知りたい

この要望に対して仮想化技術, 特にDockerを用いて環境を整えることで難しい環境構築にコストをかけずに開発を始めることができる.
そこで仮想化技術の概念について理解し, Dockerを用いて環境構築を行うことを目的として本リポジトリを作成する. 読者のレベルとしては基本的なUnixコマンドが使えること, ネットワークに関する基礎的な知識を有していることを想定している.  
2章では仮想化技術としてサーバ仮想化について説明した後, Dockerとは何か簡単に説明する. 3章では本ドキュメントの実行環境と, Docker自体の環境構築に参考となるサイトの紹介を行う. 4章では実際にDockerを用いて開発環境を整える方法を紹介する. 環境構築ではチュートリアルイメージと公式イメージを動作させた後にDockerfileを用いて環境構築を行う方法と, docker-composeを用いて複数のイメージを組み合わせた環境を構築する方法について説明する.

## 2. Dockerの概念
本章ではDockerの概念としてサーバ仮想化とよびDockerの概要について説明する.

### 2.1 サーバ仮想化
仮想化技術とは物理構成(ハードウェア)の機能を論理構成(ソフトウェア)によって実現する技術である. 仮想化技術の一つにサーバ仮想化と呼ばれる, 1台の物理サーバ上で複数の仮想的なサーバを動作指せる技術がある. サーバ仮想化にはホスト型仮想化, ハイパバイザ型仮想化, コンテナ型仮想化の3種類がある.  
ホスト型仮想化は次に示すような構成でサーバ仮想化を行う方法である. ホスト型仮想化ではハードウェア上で動作するホストOSに, 仮想化ソフトウェアをインストールする. そして仮想化ソフトウェア上でゲストOSを動作させ, ゲストOSでアプリケーションが動作する. 

![img](./img/vm_host.png)

ホスト型仮想化でサーバ仮想化を行った環境の例を次に示す. この例ではハードウェアに搭載されているWindows10上に仮想化ソフトウェアとしてVirtualBox[1]をインストールしている. VirtulBoxではCentOSとUbuntuの2つのゲストOSが動作している. CentOSではRubyとSQLite, UbuntuではPythonとNginxのアプリケーションが動作している.

![img](./img/vm_host_ex.png)

ホスト型仮想化のメリットは既存のマシンを利用してサーバ仮想化が行えること, 仮想化に必要なソフトウェアが扱いやすいことがあげられる. 一方デメリットとしては後述するハイパーバイザー型の仮想化ソフトウェアに比べて仮想サーバの動作が遅いこと, ホストOSを動作させるために物理リソースが必要であることがあげられる. リソース面, 動作速度面から本番環境に適しているとは言えないがテスト用の環境であれば問題なく使うことができる.  
次にハイパーバイザー型仮想化について説明する. ハイパーバイザー型仮想化は次に示すような構成でサーバ仮想化を行う方法である. 仮想化のためのOSのような役割としてハイパーバイザーがあり, ハイパーバイザー上でゲストOSが動作する. 

![img](./img/hypervisor.png)

ハイパーバイザー型でサーバ仮想化を行った環境の例を次に示す. この例はWindowsでWindows Subsystem for Linux(WSL2)を利用するために, Hyper-Vと呼ばれるハイパーバイザー上にWindows10とUbuntuの2つのゲストOSを配置している.

![img](./img/hypervisor_ex.png)

ハイパーバイザー型仮想化のメリットはホストOSが不要でハードウェアを直接制御できること, システム全体としてリソースの使用効率がいいこと, 管理するサーバの台数削減が可能であることがあげられる. 一方でデメリットとして仮想化環境の高度な管理を実現するツールが標準装備されていないことがある, ハードウェアのスペックが低い場合は処理能力不足になることがある, 頻繁にアップデートが必要なものがあるため運用保守の観点にコストがかかることがあげられる.

### 2.2 Dockerとは
## 3. 実行環境とDockerの環境構築
### 3.1 実行環境
### 3.2 Dockerの環境構築
## 4. Dockerの使い方
### 4.1 Hello World!
### 4.2 イメージとコンテナ
### 4.3 Dockerfile
### 4.4 docker-compose
## 参考文献